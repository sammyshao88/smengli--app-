<!DOCTYPE html>  
<html lang="zh-CN">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>è‹±è¯­å‘éŸ³æµ‹è¯•åŠ©æ‰‹</title>  
    <style>  
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }  
        .card { background: white; padding: 2rem; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 90%; max-width: 400px; text-align: center; }  
        h1 { color: #1a73e8; font-size: 24px; }  
        #target-text { font-size: 20px; font-weight: bold; margin: 20px 0; color: #333; min-height: 50px; }  
        .btn-group { display: flex; flex-direction: column; gap: 10px; }  
        button { padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; transition: 0.3s; }  
        .btn-play { background-color: #e8f0fe; color: #1a73e8; }  
        .btn-mic { background-color: #1a73e8; color: white; }  
        .btn-mic:disabled { background-color: #ccc; }  
        .btn-next { background-color: #34a853; color: white; margin-top: 10px; }  
        #result { margin-top: 20px; padding: 15px; border-radius: 8px; display: none; }  
        .success { background-color: #e6f4ea; color: #1e8e3e; border: 1px solid #1e8e3e; }  
        .error { background-color: #fce8e6; color: #d93025; border: 1px solid #d93025; }  
        .score { font-size: 24px; font-weight: bold; }  
    </style>  
</head>  
<body>  
  
<div class="card">  
    <h1>è‹±è¯­å‘éŸ³ç»ƒä¹ </h1>  
    <div id="target-text">Loading...</div>  
      
    <div class="btn-group">  
        <button class="btn-play" onclick="playText()">ğŸ”Š å¬èŒƒè¯»</button>  
        <button id="mic-btn" class="btn-mic" onclick="startRecording()">ğŸ¤ å¼€å§‹å½•éŸ³ (è¯·æœ—è¯»)</button>  
        <button class="btn-next" onclick="nextSentence()">ä¸‹ä¸€å¥</button>  
    </div>  
  
    <div id="result">  
        <div id="score-text" class="score">0åˆ†</div>  
        <p id="feedback-text"></p>  
        <p style="font-size: 12px; color: #666;">ä½ è¯»çš„æ˜¯: <span id="user-said"></span></p>  
    </div>  
</div>  
  
<script>  
    const sentences = [  
        "Hello, how are you today?",  
        "I love practicing English every morning.",  
        "The quick brown fox jumps over the lazy dog.",  
        "Artificial intelligence is changing the world.",  
        "Can you help me with my pronunciation?"  
    ];  
      
    let currentIndex = 0;  
    const targetDisplay = document.getElementById('target-text');  
    const micBtn = document.getElementById('mic-btn');  
    const resultDiv = document.getElementById('result');  
    const scoreText = document.getElementById('score-text');  
    const feedbackText = document.getElementById('feedback-text');  
    const userSaidText = document.getElementById('user-said');  
  
    // åˆå§‹åŒ–æ˜¾ç¤º  
    targetDisplay.innerText = sentences[currentIndex];  
  
    // 1. æ’­æ”¾èŒƒè¯» (TTS)  
    function playText() {  
        const msg = new SpeechSynthesisUtterance(sentences[currentIndex]);  
        msg.lang = 'en-US';  
        window.speechSynthesis.speak(msg);  
    }  
  
    // 2. åˆ‡æ¢å¥å­  
    function nextSentence() {  
        currentIndex = (currentIndex + 1) % sentences.length;  
        targetDisplay.innerText = sentences[currentIndex];  
        resultDiv.style.display = 'none';  
    }  
  
    // 3. æ ¸å¿ƒåŠŸèƒ½ï¼šè¯­éŸ³è¯†åˆ«ä¸è¯„åˆ†  
    function startRecording() {  
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();  
        recognition.lang = 'en-US';  
        recognition.interimResults = false;  
  
        micBtn.disabled = true;  
        micBtn.innerText = "æ­£åœ¨å€¾å¬...";  
  
        recognition.start();  
  
        recognition.onresult = (event) => {  
            const userSpeech = event.results[0][0].transcript.toLowerCase().replace(/[.,/#!$%^&*;:{}=\-_`~()]/g,"");  
            const targetSpeech = sentences[currentIndex].toLowerCase().replace(/[.,/#!$%^&*;:{}=\-_`~()]/g,"");  
              
            compareSpeech(userSpeech, targetSpeech);  
        };  
  
        recognition.onerror = () => {  
            alert("å½•éŸ³å‡ºé”™ï¼Œè¯·ç¡®ä¿å¼€å¯éº¦å…‹é£æƒé™ã€‚");  
            micBtn.disabled = false;  
            micBtn.innerText = "ğŸ¤ å¼€å§‹å½•éŸ³";  
        };  
  
        recognition.onend = () => {  
            micBtn.disabled = false;  
            micBtn.innerText = "ğŸ¤ å¼€å§‹å½•éŸ³";  
        };  
    }  
  
    // 4. ç®€å•çš„è¯„åˆ†é€»è¾‘  
    function compareSpeech(user, target) {  
        userSaidText.innerText = user;  
        resultDiv.style.display = 'block';  
  
        const userWords = user.split(' ');  
        const targetWords = target.split(' ');  
          
        let matches = 0;  
        targetWords.forEach(word => {  
            if (userWords.includes(word)) matches++;  
        });  
  
        const score = Math.round((matches / targetWords.length) * 100);  
        scoreText.innerText = score + "åˆ†";  
  
        if (score >= 80) {  
            resultDiv.className = "success";  
            feedbackText.innerText = "å¤ªæ£’äº†ï¼å‘éŸ³éå¸¸æ ‡å‡†ã€‚";  
        } else if (score >= 50) {  
            resultDiv.className = "success";  
            feedbackText.innerText = "è¿˜ä¸é”™ï¼Œç»§ç»­åŠªåŠ›ã€‚";  
        } else {  
            resultDiv.className = "error";  
            feedbackText.innerText = "æ²¡å¬æ¸…ï¼Œå†è¯•ä¸€æ¬¡ï¼Ÿ";  
        }  
    }  
</script>  
  
</body>  
</html>  